angular.module("app",[]),angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc","$rootScope",function(o,t,n){o.$on("login",function(o,t){n.currentUser=t}),o.logout=function(){o.currentUser="",t.logout()}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,t){o.login=function(n,e){t.login(n,e).then(function(t){o.$emit("login",t.data)})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc","$rootScope",function(o,t){t.fetch().success(function(t){o.posts=t}),o.addPost=function(){o.postBody&&t.create({body:o.postBody}).success(function(){o.postBody=null})},o.$on("ws:new_post",function(t,n){o.$apply(function(){o.posts.unshift(n)})})}]),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,t){o.register=function(o,n){t.register(o,n).then(function(){alert("Congratulations Now pls login")})}}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var t=this;t.getUser=function(){return o.get("/api/users")},t.login=function(n,e){return o.post("/api/sessions",{username:n,password:e}).then(function(n){return t.token=n.data,o.defaults.headers.common["X-Auth"]=n.data,console.log("inside login",o.defaults.headers.common),t.getUser()})},t.register=function(n,e){return o.post("/api/users",{username:n,password:e}).then(function(){return t.login(n,e)})},t.logout=function(){delete o.defaults.headers.common["X-Auth"]}}]),angular.module("app").service("WebSocketSvc",["$rootScope","$window",function(o,t){function n(){return"https:"===t.location.protocol?"wss://"+window.location.host:"ws://"+window.location.host}var e;this.connect=function(){e=new WebSocket(n()),e.onmessage=function(t){var n=JSON.parse(t.data);o.$broadcast("ws:"+n.topic,n.data)}},this.send=function(o,t){var n=JSON.stringify({topic:o,data:t});e.send(n)}}]).run(["WebSocketSvc",function(o){o.connect()}]),angular.module("app").run(["$rootScope","$timeout",function(o,t){!function n(){var e="ws://localhost:3000",r=new WebSocket(e);r.onclose=function(){console.log("WebSocket closed. Reconnecting..."),t(n,1e4)},r.onmessage=function(t){var n=JSON.parse(t.data);o.$broadcast("ws:"+n.topic,n.data)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldC5zdmMuanMiLCJ3ZWJzb2NrZXRzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiVXNlclN2YyIsIiRyb290U2NvcGUiLCIkb24iLCJfIiwidXNlciIsImN1cnJlbnRVc2VyIiwibG9nb3V0IiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInJlc3BvbnNlIiwiJGVtaXQiLCJkYXRhIiwiUG9zdHNTdmMiLCJmZXRjaCIsInN1Y2Nlc3MiLCJwb3N0cyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJwb3N0IiwiJGFwcGx5IiwidW5zaGlmdCIsInNlcnZpY2UiLCIkaHR0cCIsInRoaXMiLCJnZXQiLCJyZWdpc3RlciIsImFsZXJ0IiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJnZXRVc2VyIiwidmFsIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJjb25zb2xlIiwibG9nIiwiJHdpbmRvdyIsIndlYnNvY2tldEhvc3QiLCJsb2NhdGlvbiIsInByb3RvY29sIiwid2luZG93IiwiaG9zdCIsImNvbm5lY3Rpb24iLCJjb25uZWN0IiwiV2ViU29ja2V0Iiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiLCJzZW5kIiwianNvbiIsInN0cmluZ2lmeSIsInJ1biIsIldlYlNvY2tldFN2YyIsIiR0aW1lb3V0IiwidXJsIiwib25jbG9zZSJdLCJtYXBwaW5ncyI6IkFBR0FBLFFBQUFDLE9BQUEs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SCxFQUFBekMsS0FDQVosR0FBQXlELFdBQUEsTUFBQUgsRUFBQUksTUFBQUosRUFBQTFDLFFBR0FjLEtBQUFpQyxLQUFBLFNBQUFELEVBQUE5QyxHQUNBLEdBQUFnRCxHQUFBTCxLQUFBTSxXQUFBSCxNQUFBQSxFQUFBOUMsS0FBQUEsR0FDQXFDLEdBQUFVLEtBQUFDLE9BRUFFLEtBQUEsZUFBQSxTQUFBQyxHQUNBQSxFQUFBYixhQ3ZCQXZELFFBQUFDLE9BQUEsT0FDQWtFLEtBQUEsYUFBQSxXQUFBLFNBQUE5RCxFQUFBZ0UsSUFDQSxRQUFBZCxLQUNBLEdBQUFlLEdBQUEsc0JBQ0FoQixFQUFBLEdBQUFFLFdBQUFjLEVBQ0FoQixHQUFBaUIsUUFBQSxXQUNBekIsUUFBQUMsSUFBQSxxQ0FDQXNCLEVBQUFkLEVBQUEsTUFFQUQsRUFBQUcsVUFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFDLEtBQUFDLE1BQUFILEVBQUF6QyxLQUNBWixHQUFBeUQsV0FBQSxNQUFBSCxFQUFBSSxNQUFBSixFQUFBMUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcnNoYXZhcmRoYW4gb24gMTUtMDItMTcuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnLFtdKTtcbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ1JvdXRlJ1xuXSkiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyc2hhdmFyZGhhbiBvbiAxNS0wMi0xNy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLGZ1bmN0aW9uICgkc2NvcGUsVXNlclN2Yywkcm9vdFNjb3BlKSB7XG5cdFx0JHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXJcblx0XHR9KVxuXHRcdCRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcblx0XHRcdCRzY29wZS5jdXJyZW50VXNlciA9ICcnO1xuXHRcdFx0VXNlclN2Yy5sb2dvdXQoKTtcblx0XHR9XG5cdH0pIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcnNoYXZhcmRoYW4gb24gMTUtMDItMTcuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuXHRcdCRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRcdFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0XHRcdFx0XHQkc2NvcGUuJGVtaXQoJ2xvZ2luJywgcmVzcG9uc2UuZGF0YSlcblx0XHRcdFx0fSlcblx0XHR9XG5cdH0pIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcnNoYXZhcmRoYW4gb24gMTUtMDItMTcuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdQb3N0c0N0cmwnLGZ1bmN0aW9uKCRzY29wZSxQb3N0c1N2Yywkcm9vdFNjb3BlKXtcblxuXHRQb3N0c1N2Yy5mZXRjaCgpLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpIHtcblx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcblx0fSlcblx0JHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpIHtcblx0XHRpZigkc2NvcGUucG9zdEJvZHkpe1xuXG5cdFx0XHRQb3N0c1N2Yy5jcmVhdGUoe1xuXHRcdFx0XHRib2R5IDokc2NvcGUucG9zdEJvZHlcblx0XHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24oKXtcblx0XHRcdFx0JHNjb3BlLnBvc3RCb2R5ID0gbnVsbDtcblx0XHRcdH0pXG5cdFx0fVxuXG5cdH1cblxuXHQkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uIChfLCBwb3N0KSB7XG5cdFx0JHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KVxuXHRcdH0pXG5cdH0pXG59KSIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJzaGF2YXJkaGFuIG9uIDE1LTAyLTE3LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJykuc2VydmljZSgnUG9zdHNTdmMnLFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuXHR0aGlzLmZldGNoID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycpXG5cdH1cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KSB7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMnLHBvc3QpO1xuXHR9XG59XSkiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyc2hhdmFyZGhhbiBvbiAxNS0wMi0xNy5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRcdFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRhbGVydChcIkNvbmdyYXR1bGF0aW9ucyBOb3cgcGxzIGxvZ2luXCIpO1xuXHRcdFx0XHR9KVxuXHRcdH1cblx0fSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGhhcnNoYXZhcmRoYW4gb24gMTUtMDItMTcuXG4gKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuXHRcdCRyb3V0ZVByb3ZpZGVyXG5cdFx0XHQud2hlbignLycsIHsgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCcgfSlcblx0XHRcdC53aGVuKCcvcmVnaXN0ZXInLCB7IGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnIH0pXG5cdFx0XHQud2hlbignL2xvZ2luJywgeyBjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyB9KVxuXHR9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJzaGF2YXJkaGFuIG9uIDE1LTAyLTE3LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcblx0XHR2YXIgc3ZjID0gdGhpc1xuXHRcdHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXG5cdFx0fVxuXHRcdHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuXHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuXHRcdFx0fSkudGhlbihmdW5jdGlvbiAodmFsKSB7XG5cdFx0XHRcdHN2Yy50b2tlbiA9IHZhbC5kYXRhO1xuXHRcdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB2YWwuZGF0YTtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJpbnNpZGUgbG9naW5cIiwkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbik7XG5cdFx0XHRcdHJldHVybiBzdmMuZ2V0VXNlcigpXG5cdFx0XHR9KVxuXHRcdH1cblx0XHRzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcblx0XHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcblx0XHRcdH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXR1cm4gc3ZjLmxvZ2luKHVzZXJuYW1lLHBhc3N3b3JkKTtcblx0XHRcdH0pXG5cdFx0fVxuXHRcdHN2Yy5sb2dvdXQgPSBmdW5jdGlvbigpe1xuXHRcdFx0ZGVsZXRlICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ107XG5cdFx0fVxuXHR9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBoYXJzaGF2YXJkaGFuIG9uIDE1LTAyLTE4LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LnNlcnZpY2UoJ1dlYlNvY2tldFN2YycsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCR3aW5kb3cpIHtcblx0XHRmdW5jdGlvbiB3ZWJzb2NrZXRIb3N0KCkge1xuXHRcdFx0aWYgKCR3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIpIHtcblx0XHRcdFx0cmV0dXJuIFwid3NzOi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIFwid3M6Ly9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dmFyIGNvbm5lY3Rpb25cblx0XHR0aGlzLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpXG5cdFx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpXG5cdFx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5zZW5kID0gZnVuY3Rpb24gKHRvcGljLCBkYXRhKSB7XG5cdFx0XHR2YXIganNvbiA9IEpTT04uc3RyaW5naWZ5KHt0b3BpYzogdG9waWMsIGRhdGE6IGRhdGF9KVxuXHRcdFx0Y29ubmVjdGlvbi5zZW5kKGpzb24pXG5cdFx0fVxuXHR9KS5ydW4oZnVuY3Rpb24gKFdlYlNvY2tldFN2Yykge1xuXHRcdFdlYlNvY2tldFN2Yy5jb25uZWN0KClcblx0fSkiLCIvKipcbiAqIENyZWF0ZWQgYnkgaGFyc2hhdmFyZGhhbiBvbiAxNS0wMi0xOC5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XG5cdFx0KGZ1bmN0aW9uIGNvbm5lY3QoKSB7XG5cdFx0XHR2YXIgdXJsID0gJ3dzOi8vbG9jYWxob3N0OjMwMDAnXG5cdFx0XHR2YXIgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQodXJsKVxuXHRcdFx0Y29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ1dlYlNvY2tldCBjbG9zZWQuIFJlY29ubmVjdGluZy4uLicpXG5cdFx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDEwKjEwMDApXG5cdFx0XHR9XG5cdFx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpXG5cdFx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcblx0XHRcdH1cblx0XHR9KSgpXG5cdH0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=